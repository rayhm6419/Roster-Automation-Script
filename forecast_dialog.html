<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; padding: 16px; }
      label { display:block; margin-bottom: 6px; font-weight: 600; }
      input[type="date"] { width: 100%; padding: 8px; box-sizing: border-box; }
      .row { margin-top: 16px; display:flex; gap: 8px; }
      button { padding: 8px 12px; cursor: pointer; }
      .primary { background:#1a73e8; color:#fff; border:none; }
    </style>
  </head>
  <body>
    <label>选择日期（范围：{{ minISO }} ~ {{ maxISO }}）</label>
    <input id="picker" type="date" min="<?= minISO ?>" max="<?= maxISO ?>" value="<?= defaultISO ?>">

    <div class="row">
      <button class="primary" onclick="submit()">生成司机表</button>
      <button onclick="google.script.host.close()">取消</button>
    </div>

    <script>
      function submit(){
        const v = document.getElementById('picker').value;
        if(!v){ alert('请先选择日期'); return; }
        google.script.run
          .withSuccessHandler(function(dateStr){
            alert('已按 ' + dateStr + ' 生成司机表');
            google.script.host.close();
          })
          .withFailureHandler(function(err){
            alert('失败：' + (err && err.message || err));
          })
          .doForecastForDateString(v);
      }
    </script>
  </body>
</html>
